var Thumnail=function(t,e){var i=this,n="thumnailWindow",a=600,s=null,r=null;this.settings=$.extend({},this.defaults,e),this.queue=null,this.$window=null,this.data={srl:t.settings.thumnail.srl,coords:t.settings.thumnail.coords?JSON.parse("["+t.settings.thumnail.coords+"]"):null,url:t.settings.thumnail.url,location:null};var d=function(){var t='<div id="'+n+'">\n';return t+='<div class="bg"></div>\n',t+='<div class="wrap">\n',t+="<figure></figure>\n",t+="<dl>\n",t+="<dt>출력사이즈</dt>\n",t+='<dd>가로:<em ar-text="width">0</em>px, 세로:<em ar-text="height">0</em>px</dd>\n',t+="</dl>\n",t+="<nav>\n",t+='<button type="button" rg-action="center" class="ui-button btn-highlight">중간으로</button>\n',t+='<button type="button" rg-action="close" class="ui-button">닫기</button>\n',t+="</nav>\n",t+="</div>\n",t+="</div>",$(t)},o=function(t,e){var i=parseInt(t)/parseInt(e);return i=Math.round(1e3*i)/1e3},h=function(t,e){var n=new Array;switch(e){case"resize":n=[t.width(),t.height()];break;case"resizeWidth":n[0]=parseInt(i.settings.size[0]),n[1]=parseInt(t.height()/t.width()*i.settings.size[0]);break;case"resizeHeight":n[0]=parseInt(t.width()/t.height()*i.settings.size[1]),n[1]=parseInt(i.settings.size[1]);break;default:n=i.settings.size}return o(n[0],n[1])},l=function(t,e,i){var n,a;switch(e){case"resize":t.width()<t.height()?(n=parseInt(t.width()/t.height()*i[1]),a=parseInt(i[1])):(n=parseInt(i[0]),a=parseInt(t.height()/t.width()*i[0]));break;case"resizeWidth":n=parseInt(i[0]),a=parseInt(t.height()/t.width()*i[0]);break;case"resizeHeight":n=parseInt(t.width()/t.height()*i[1]),a=parseInt(i[1]);break;default:n=parseInt(i[0]),a=parseInt(i[1])}return[n,a]},u=function(t,e,i){t.width()>t.height()?(t.width(t.width()*i),t.width()>e&&t.width(e)):(t.height(t.height()*i),t.height()>e&&t.height(e))},g=function(t,e,i){return i?i:"crop"==e?t.width()<t.height()?[0,0,t.width(),0]:[0,0,0,t.height()]:[0,0,t.width(),t.height()]},c=function(t){var e=i.$window.find("figure > img");r=h(e,i.settings.type),s=l(e,i.settings.type,i.settings.size),i.$window.find("[ar-text=width]").text(s[0]),i.$window.find("[ar-text=height]").text(s[1]),u(e,a,.7),i.data.coords=g(e,i.settings.type,i.data.coords),e.Jcrop({bgOpacity:.4,setSelect:i.data.coords,aspectRatio:r,minSize:[50,50],onSelect:function(t){i.data.coords=[parseInt(t.x),parseInt(t.y)>0?parseInt(t.y):0,parseInt(t.x2),parseInt(t.y2),parseInt(t.w),parseInt(t.h)]}},function(){var t=this,n=i.$window.find("button[rg-action=center]"),a=i.$window.find("button[rg-action=close], div.bg"),s=i.$window.find("div.wrap");$("body").addClass("thumnailWindowMode"),s.css({marginLeft:0-.5*s.width()+"px"}),n.on("click",function(n){var a,s,r,d,o=t.tellSelect();a=.5*e.width()-.5*o.w,s=.5*e.height()-.5*o.h,i.data.coords=[parseInt(a),parseInt(s)>0?parseInt(s):0,parseInt(a+o.w),parseInt(s+o.h),parseInt(o.w),parseInt(o.h)],t.animateTo(i.data.coords)}),a.on("click",function(t){i.close()})})},w=function(t){var e=$('<canvas width="'+s[0]+'" height="'+s[1]+'" />'),n=e.get(0).getContext("2d"),a=i.$window.find("figure > img"),r=[a.get(0).naturalWidth,a.get(0).naturalHeight],d=i.data.coords,o=[r[0]/a.width(),r[1]/a.height()];return n.fillStyle="#ffffff",n.fillRect(0,0,s[0],s[1]),n.drawImage(a.get(0),d[0]*o[0],d[1]*o[1],d[4]*o[0],d[5]*o[1],0,0,s[0],s[1]),e.get(0).toDataURL("image/jpeg",i.settings.quality)};this.open=function(e){if(!i.$window){i.queue=e,i.$window=d(),e.srl!==i.data.srl&&(i.data.coords=null),i.data.srl=e.srl,i.data.location=t.settings.fileDir+e.location;var n=i.$window.find("figure"),a=$('<img src="'+i.data.location+'" />');n.append(a),$("body").append(i.$window),a.get(0).onload=c}},this.close=function(){var e=t.settings.thumnail.srl,n=t.settings.thumnail.coords;(i.data.srl!==e||i.data.coords.toString()!==n)&&(i.data.image=w(i.data.location),t.queue.updateThumnailClass(i.queue.element)),$("body").removeClass("thumnailWindowMode"),i.$window.remove(),i.$window=null,i.queue=null}};Thumnail.prototype.defaults={type:"crop",size:[200,200],quality:.7};
//# sourceMappingURL=./Thumnail.class.min.js.map